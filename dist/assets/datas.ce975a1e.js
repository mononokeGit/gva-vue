/*! 
 Build based on gin-vue-admin 
 Time : 1678795244000 */
import{s as a}from"./authority.63d62beb.js";import{W as t}from"./warningBar.e58a79fd.js";import{r as e,b as l,o as r,c as u,e as o,d as i,w as s,h as n,F as d,t as c,m as h,v as y,i as f}from"./index.a10c697d.js";const m={class:"clearfix sticky-button",style:{margin:"18px"}},p={class:"tree-content"},v={name:"Datas"},I=Object.assign(v,{props:{row:{default:function(){return{}},type:Object},authority:{default:function(){return[]},type:Array}},emits:["changeRow"],setup(v,{expose:I,emit:g}){const w=v,b=e([]),x=e(!1),k=a=>{a&&a.forEach((a=>{const t={};t.authorityId=a.authorityId,t.authorityName=a.authorityName,b.value.push(t),a.children&&a.children.length&&k(a.children)}))},A=e([]);k(w.authority),w.row.dataAuthorityId&&w.row.dataAuthorityId.forEach((a=>{const t=b.value&&b.value.filter((t=>t.authorityId===a.authorityId))&&b.value.filter((t=>t.authorityId===a.authorityId))[0];A.value.push(t)}));const C=()=>{A.value=[...b.value],g("changeRow","dataAuthorityId",A.value),x.value=!0},_=()=>{A.value=b.value.filter((a=>a.authorityId===w.row.authorityId)),g("changeRow","dataAuthorityId",A.value),x.value=!0},j=()=>{const a=[];R(w.row,a),A.value=b.value.filter((t=>a.indexOf(t.authorityId)>-1)),g("changeRow","dataAuthorityId",A.value),x.value=!0},R=(a,t)=>{t.push(a.authorityId),a.children&&a.children.forEach((a=>{R(a,t)}))},z=async()=>{0===(await a(w.row)).code&&f({type:"success",message:"资源设置成功"})},N=()=>{g("changeRow","dataAuthorityId",A.value),x.value=!0};return I({enterAndNext:()=>{z()},needConfirm:x}),(a,e)=>{const f=l("el-button"),v=l("el-checkbox"),I=l("el-checkbox-group");return r(),u("div",null,[o(t,{title:"此功能仅用于创建角色和角色的many2many关系表，具体使用还须自己结合表实现业务，详情参考示例代码（客户示例）。此功能不建议使用，建议使用插件市场【组织管理功能（点击前往）】来管理资源权限。",href:"https://plugin.gin-vue-admin.com/#/layout/newPluginInfo?id=36"}),i("div",m,[o(f,{class:"fl-right",size:"small",type:"primary",onClick:z},{default:s((()=>[n("确 定")])),_:1}),o(f,{class:"fl-left",size:"small",type:"primary",onClick:C},{default:s((()=>[n("全选")])),_:1}),o(f,{class:"fl-left",size:"small",type:"primary",onClick:_},{default:s((()=>[n("本角色")])),_:1}),o(f,{class:"fl-left",size:"small",type:"primary",onClick:j},{default:s((()=>[n("本角色及子角色")])),_:1})]),i("div",p,[o(I,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=a=>A.value=a),onChange:N},{default:s((()=>[(r(!0),u(d,null,c(b.value,((a,t)=>(r(),h(v,{key:t,label:a},{default:s((()=>[n(y(a.authorityName),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])])}}});export{I as default};
