/*! 
 Build based on gin-vue-admin 
 Time : 1678795244000 */
import{r as e,a as l,b as a,o as t,c as u,e as o,w as d,h as n,d as i,k as s,i as r,P as p}from"./index.a10c697d.js";import{u as m,g as c,d as v,f,a as h,c as b}from"./lPnum.28f8d26e.js";import g from"./phoneNum.7a1d261d.js";import"./date.34b11046.js";import"./dictionary.f99b60b8.js";import"./phoneNum.ff37cdeb.js";import"./format.7d611a05.js";import"./sysDictionary.5409d8a6.js";const y={class:"gva-search-box"},_={class:"gva-table-box"},V={class:"gva-btn-list"},w=i("p",null,"确定要删除吗？",-1),N={style:{"text-align":"right","margin-top":"8px"}},U={class:"gva-pagination"},k={class:"dialog-footer"},z=i("div",null,null,-1),C=i("div",{class:"card-header"},[i("span",null,"需要号码的科室或人员")],-1),I=i("div",{class:"card-header"},[i("span",null,"待分配的号码")],-1),x={name:"LPhone"},P=Object.assign(x,{setup(x){const P=e({IPhone:0,lName:"",lNum:0,lOther:"",lTitle:"",lUnit:""}),T=l({}),j=e(),O=e([]),D=e=>{O.value=e},S=e(1),M=e(0),B=e(10),K=e([]),F=e({}),L=()=>{F.value={},E()},R=()=>{S.value=1,B.value=10,E()},q=e=>{B.value=e,E()},A=e=>{S.value=e,E()},E=async()=>{const e=await c({page:S.value,pageSize:B.value,...F.value});0===e.code&&(K.value=e.data.list,M.value=e.data.total,S.value=e.data.page,B.value=e.data.pageSize)};E();(async()=>{})();const G=e([]),H=e=>{G.value=e},J=e(!1),Q=async()=>{const e=[];if(0===G.value.length)return void r({type:"warning",message:"请选择要删除的数据"});G.value&&G.value.map((l=>{e.push(l.ID)}));0===(await v({ids:e})).code&&(r({type:"success",message:"删除成功"}),K.value.length===e.length&&S.value>1&&S.value--,J.value=!1,E())},W=e(""),X=async e=>{0===(await h({ID:e.ID})).code&&(r({type:"success",message:"删除成功"}),1===K.value.length&&S.value>1&&S.value--,E())},Y=e(!1),Z=()=>{W.value="create",Y.value=!0},$=()=>{Y.value=!1,P.value={IPhone:0,lName:"",lNum:0,lOther:"",lTitle:"",lUnit:""}},ee=async()=>{var e;null==(e=j.value)||e.validate((async e=>{if(!e)return;let l;switch(W.value){case"create":default:l=await b(P.value);break;case"update":l=await m(P.value)}0===l.code&&(r({type:"success",message:"创建/更改成功"}),$(),E())}))};return(e,l)=>{const c=a("el-divider"),v=a("el-input"),h=a("el-form-item"),b=a("el-button"),x=a("el-form"),E=a("el-popover"),le=a("el-table-column"),ae=a("el-table"),te=a("el-pagination"),ue=a("el-dialog"),oe=a("el-card"),de=a("el-col"),ne=a("el-row");return t(),u("div",null,[o(c,{"content-position":"left"},{default:d((()=>[n("1.在此区域勾选需要分配或修改号码的科室")])),_:1}),i("div",y,[o(x,{inline:!0,model:F.value,class:"demo-form-inline",onKeyup:s(R,["enter"])},{default:d((()=>[o(h,{label:"领导姓名"},{default:d((()=>[o(v,{modelValue:F.value.lName,"onUpdate:modelValue":l[0]||(l[0]=e=>F.value.lName=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),o(h,{label:"所属单位"},{default:d((()=>[o(v,{modelValue:F.value.lUnit,"onUpdate:modelValue":l[1]||(l[1]=e=>F.value.lUnit=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),o(h,{label:"职务"},{default:d((()=>[o(v,{modelValue:F.value.lTitle,"onUpdate:modelValue":l[2]||(l[2]=e=>F.value.lTitle=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),o(h,{label:"电话号码"},{default:d((()=>[o(v,{modelValue:F.value.IPhone,"onUpdate:modelValue":l[3]||(l[3]=e=>F.value.IPhone=e),modelModifiers:{number:!0},placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),o(h,{label:"备注"},{default:d((()=>[o(v,{modelValue:F.value.lOther,"onUpdate:modelValue":l[4]||(l[4]=e=>F.value.lOther=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),o(h,null,{default:d((()=>[o(b,{size:"small",type:"primary",icon:"search",onClick:R},{default:d((()=>[n("查询")])),_:1}),o(b,{size:"small",icon:"refresh",onClick:L},{default:d((()=>[n("重置")])),_:1})])),_:1})])),_:1},8,["model","onKeyup"])]),i("div",_,[i("div",V,[o(b,{size:"small",type:"primary",icon:"plus",onClick:Z},{default:d((()=>[n("新增")])),_:1}),o(E,{visible:J.value,"onUpdate:visible":l[7]||(l[7]=e=>J.value=e),placement:"top",width:"160"},{reference:d((()=>[o(b,{icon:"delete",size:"small",style:{"margin-left":"10px"},disabled:!G.value.length,onClick:l[6]||(l[6]=e=>J.value=!0)},{default:d((()=>[n("删除")])),_:1},8,["disabled"])])),default:d((()=>[w,i("div",N,[o(b,{size:"small",type:"primary",link:"",onClick:l[5]||(l[5]=e=>J.value=!1)},{default:d((()=>[n("取消")])),_:1}),o(b,{size:"small",type:"primary",onClick:Q},{default:d((()=>[n("确定")])),_:1})])])),_:1},8,["visible"])]),o(ae,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:K.value,"row-key":"ID",onSelectionChange:H},{default:d((()=>[o(le,{type:"selection",width:"55"}),o(le,{sortable:"",align:"left",label:"序号",prop:"lNum",width:"120"}),o(le,{align:"left",label:"领导姓名",prop:"lName",width:"120"}),o(le,{align:"left",label:"职务",prop:"lTitle",width:"auto"}),o(le,{align:"left",label:"所属单位",prop:"lUnit",width:"auto"}),o(le,{align:"left",label:"号码",prop:"IPhone",width:"120"}),o(le,{align:"left",label:"备注",prop:"lOther",width:"120"}),o(le,{align:"left",label:"操作"},{default:d((e=>[o(b,{type:"primary",link:"",icon:"edit",size:"small",class:"table-button",onClick:l=>(async e=>{const l=await f({ID:e.ID});W.value="update",0===l.code&&(P.value=l.data.relPhone,Y.value=!0)})(e.row)},{default:d((()=>[n("变更")])),_:2},1032,["onClick"]),o(b,{type:"primary",link:"",icon:"delete",size:"small",onClick:l=>{return a=e.row,void p.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{X(a)}));var a}},{default:d((()=>[n("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),i("div",U,[o(te,{layout:"total, sizes, prev, pager, next, jumper","current-page":S.value,"page-size":B.value,"page-sizes":[5,10,15,20,30,50,100],total:M.value,onCurrentChange:A,onSizeChange:q},null,8,["current-page","page-size","total"])])]),o(ue,{modelValue:Y.value,"onUpdate:modelValue":l[14]||(l[14]=e=>Y.value=e),"before-close":$,title:"弹窗操作"},{footer:d((()=>[i("div",k,[o(b,{size:"small",type:"primary",onClick:ee},{default:d((()=>[n("确 定")])),_:1}),o(b,{size:"small",onClick:$},{default:d((()=>[n("取 消")])),_:1})])])),default:d((()=>[o(h,{label:"领导序号:",prop:"lNum"},{default:d((()=>[o(v,{modelValue:P.value.lNum,"onUpdate:modelValue":l[8]||(l[8]=e=>P.value.lNum=e),modelModifiers:{number:!0},clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),o(h,{label:"领导姓名:",prop:"lName"},{default:d((()=>[o(v,{modelValue:P.value.lName,"onUpdate:modelValue":l[9]||(l[9]=e=>P.value.lName=e),clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),o(h,{label:"领导职务:",prop:"lTitle"},{default:d((()=>[o(v,{modelValue:P.value.lTitle,"onUpdate:modelValue":l[10]||(l[10]=e=>P.value.lTitle=e),clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),o(h,{label:"所属单位:",prop:"lUnit"},{default:d((()=>[o(v,{modelValue:P.value.lUnit,"onUpdate:modelValue":l[11]||(l[11]=e=>P.value.lUnit=e),clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),o(x,{model:P.value,"label-position":"right",ref_key:"elFormRef",ref:j,rules:T,"label-width":"80px"},{default:d((()=>[o(h,{label:"号码:",prop:"IPhone"},{default:d((()=>[o(v,{modelValue:P.value.IPhone,"onUpdate:modelValue":l[12]||(l[12]=e=>P.value.IPhone=e),modelModifiers:{number:!0},clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),o(h,{label:"备注:",prop:"lOther"},{default:d((()=>[o(v,{modelValue:P.value.lOther,"onUpdate:modelValue":l[13]||(l[13]=e=>P.value.lOther=e),clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),o(c,{"content-position":"left"},{default:d((()=>[n("2.在此区域筛选号码")])),_:1}),i("div",null,[o(g,{onSelectdata:D})]),z,o(ne,{style:{display:"flex","align-items":"center"}},{default:d((()=>[o(c,{"content-position":"left"},{default:d((()=>[n("3.确认号码并分配")])),_:1}),o(de,{span:11},{default:d((()=>[o(oe,{class:"box-card"},{header:d((()=>[C])),default:d((()=>[o(ae,{data:G.value,style:{width:"100%"}},{default:d((()=>[o(le,{prop:"lNum",label:"序号",width:"180"}),o(le,{prop:"lName",label:"姓名",width:"180"}),o(le,{prop:"lUnit",label:"单位/办公室"})])),_:1},8,["data"])])),_:1})])),_:1}),o(de,{span:1},{default:d((()=>[o(b,{type:"primary",onClick:l[15]||(l[15]=e=>(async()=>{if(0==G.value.length||0==O.value.length||G.value.length!=O.value.length)r({message:"请勾选匹配数量的人员和号码",type:"warning"});else{let e=0;for(let l of G.value){let a;console.log(l,O.value[e].nNumber),l.IPhone=O.value[e].nNumber,console.log(l,O.value[e].nNumber),a=await m(l),e++,console.log(e,a),0===a.code&&r({type:"success",message:"创建/更改成功"})}}})())},{default:d((()=>[n("分配")])),_:1})])),_:1}),o(de,{span:12},{default:d((()=>[o(oe,{class:"box-card"},{header:d((()=>[I])),default:d((()=>[o(ae,{data:O.value,style:{width:"100%"}},{default:d((()=>[o(le,{prop:"nNumber",label:"号码",width:"180"}),o(le,{prop:"uid",label:"标识符",width:"180"}),o(le,{prop:"nOther",label:"备注"})])),_:1},8,["data"])])),_:1})])),_:1})])),_:1})])}}});export{P as default};
